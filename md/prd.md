# Math Helper 产品需求文档 (PRD)

> Product Requirements Document v1.0

---

## 1. 文档信息

| 属性 | 值 |
|------|-----|
| 产品名称 | Math Helper |
| 版本 | v1.0 |
| 创建日期 | 2025-12-03 |
| 状态 | 草稿 |
| 作者 | AI Product Manager |

---

## 2. 产品概述

### 2.1 产品愿景
打造一款面向大学生和考研群体的高等数学学习桌面应用，通过交互式可视化和AI辅助，让抽象的数学概念变得直观易懂。

### 2.2 产品目标
1. **核心目标**: 帮助用户建立数学直觉，深入理解高等数学概念
2. **体验目标**: 让学习数学变得有趣且高效
3. **商业目标**: 成为高数学习工具领域的首选产品

### 2.3 成功指标

| 指标类型 | 指标 | 目标值 |
|----------|------|--------|
| 功能性 | MVP功能完成率 | 100% |
| 性能 | 动画帧率 | >= 60fps |
| 性能 | 公式渲染时间 | < 100ms |
| 可用性 | 首次绘图完成时间 | < 5分钟 |
| 质量 | 崩溃率 | < 0.1% |

---

## 3. 用户画像

### 3.1 主要用户: 大学生 (小明)

| 属性 | 描述 |
|------|------|
| 年龄 | 18-22岁 |
| 身份 | 理工科大一/大二学生 |
| 场景 | 正在学习高等数学课程 |
| 目标 | 理解课堂内容，通过期末考试 |
| 痛点 | 课本抽象，概念难以想象，公式记不住 |
| 技术能力 | 基础电脑操作，熟悉常用软件 |

**典型使用场景**:
- 课后复习，希望通过可视化加深对课堂知识的理解
- 做作业时遇到困难，需要直观看到函数图像
- 考前复习，快速回顾各章节核心概念

### 3.2 次要用户: 考研学生 (小红)

| 属性 | 描述 |
|------|------|
| 年龄 | 21-25岁 |
| 身份 | 大三/大四学生或毕业生 |
| 场景 | 备战研究生考试，系统复习高数 |
| 目标 | 深入理解概念，掌握解题技巧 |
| 痛点 | 知识遗忘，理解不深刻，复习效率低 |
| 技术能力 | 熟练电脑操作 |

**典型使用场景**:
- 系统复习高数，构建完整知识体系
- 遇到难以理解的概念，需要多角度解释
- 查阅公式，快速回忆解题方法

---

## 4. 用户故事

### 4.1 函数绘图模块用户故事

| ID | 用户故事 | 优先级 | 验收标准 |
|----|----------|--------|----------|
| US-A1 | 作为学生，我想输入数学公式并看到对应的函数曲线，以便直观理解函数形状 | P0 | 1. 支持常用数学函数语法 2. 输入后100ms内显示曲线 3. 语法错误有明确提示 |
| US-A2 | 作为学生，我想通过滑动条调整函数参数，以便观察参数变化对函数的影响 | P0 | 1. 参数变化实时反映在图像上 2. 支持自定义参数范围 3. 动画流畅无卡顿 |
| US-A3 | 作为学生，我想在同一坐标系中显示多个函数，以便对比它们的差异 | P0 | 1. 支持至少5条曲线同时显示 2. 不同曲线颜色区分 3. 可单独隐藏/显示某条曲线 |
| US-A4 | 作为学生，我想看到函数的特殊点标注，以便快速识别极值、拐点等 | P1 | 1. 自动识别并标注极值点 2. 自动识别并标注拐点 3. 自动识别并标注零点 4. 点击标注显示坐标值 |
| US-A5 | 作为学生，我想绘制三维曲面图，以便理解二元函数 | P2 | 1. 支持z=f(x,y)形式输入 2. 3D视角可旋转 3. 支持颜色映射高度 |

### 4.2 知识点可视化模块用户故事

| ID | 用户故事 | 优先级 | 验收标准 |
|----|----------|--------|----------|
| US-B1 | 作为学生，我想看到极限过程的动画演示，以便理解"趋近"的含义 | P0 | 1. 动态显示x趋近a的过程 2. 同步显示f(x)趋近L 3. 可暂停/播放/调速 |
| US-B2 | 作为学生，我想看到导数的几何意义动画，以便理解切线斜率 | P0 | 1. 显示曲线上移动的点 2. 实时显示该点切线 3. 显示斜率数值变化 |
| US-B3 | 作为学生，我想看到定积分的面积填充动画，以便理解积分的几何意义 | P0 | 1. 动态填充曲线下方区域 2. 实时显示累计面积值 3. 支持调整积分区间 |
| US-B4 | 作为学生，我想看到级数部分和的累加动画，以便理解收敛过程 | P2 | 1. 逐项显示部分和 2. 标注收敛值 3. 显示误差变化 |
| US-B5 | 作为学生，我想对比不同阶数泰勒展开的逼近效果，以便理解多项式逼近 | P2 | 1. 滑动条控制展开阶数 2. 原函数与展开式同时显示 3. 显示逼近误差 |

### 4.3 AI辅助模块用户故事

| ID | 用户故事 | 优先级 | 验收标准 |
|----|----------|--------|----------|
| US-C1 | 作为学生，我想获得知识点的生活化比喻，以便用熟悉事物理解抽象概念 | P1 | 1. 每个核心概念有2-3个预设比喻 2. 可请求AI生成新比喻 3. 比喻通俗易懂 |
| US-C2 | 作为学生，我想针对知识点提问并获得AI解答，以便解决具体疑惑 | P2 | 1. 支持自然语言提问 2. 回答准确相关 3. 响应时间<5秒 |
| US-C3 | 作为学生，我想了解常见的理解误区，以便避免错误认知 | P3 | 1. 列出该知识点常见误区 2. 解释正确理解方式 |
| US-C4 | 作为学生，我想获得个性化学习路径推荐，以便高效复习 | P2 | 1. 分析薄弱知识点 2. 推荐学习顺序 3. 显示知识点依赖关系 |

### 4.4 知识体系模块用户故事

| ID | 用户故事 | 优先级 | 验收标准 |
|----|----------|--------|----------|
| US-D1 | 作为学生，我想看到知识点之间的关联图谱，以便理解整体结构 | P1 | 1. 可视化显示知识点节点 2. 连线表示依赖关系 3. 点击节点跳转详情 |
| US-D2 | 作为学生，我想通过章节大纲快速导航，以便找到目标内容 | P0 | 1. 树形结构显示全部章节 2. 点击展开/折叠 3. 点击跳转对应内容 |
| US-D3 | 作为考研学生，我想看到考研高频考点标记，以便重点复习 | P2 | 1. 高频考点有明显标记 2. 可筛选只看考研重点 |
| US-D4 | 作为学生，我想快速查阅公式卡片，以便复习和记忆 | P1 | 1. 按主题分类展示公式 2. 公式渲染清晰 3. 支持搜索 |

---

## 5. 功能需求详细规格

### 5.1 模块A: 函数绘图引擎

#### FR-A1: 公式输入与绘图

**功能描述**: 用户输入数学表达式，系统实时解析并绘制对应的函数曲线。

**输入规格**:
| 输入项 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| 函数表达式 | string | 支持Math.js语法 | `x^2 + sin(x)` |
| x轴范围 | [number, number] | 可选，默认[-10, 10] | `[-5, 5]` |
| y轴范围 | [number, number] | 可选，自动计算 | `[-10, 10]` |

**支持的数学函数**:
```
基础运算: +, -, *, /, ^, sqrt()
三角函数: sin(), cos(), tan(), asin(), acos(), atan()
对数指数: log(), ln(), exp(), e^x
其他: abs(), floor(), ceil(), round()
常量: pi, e
```

**输出规格**:
- 在坐标系中绘制函数曲线
- 显示坐标轴、网格线、刻度标签

**异常处理**:
| 异常情况 | 处理方式 |
|----------|----------|
| 语法错误 | 输入框下方显示红色错误提示 |
| 无效区间 | 自动调整为有效范围 |
| 无穷/NaN | 该点不绘制，曲线断开 |

**验收标准**:
- [ ] 输入合法表达式后100ms内显示曲线
- [ ] 支持上述所有数学函数
- [ ] 语法错误时显示明确的错误信息
- [ ] 坐标系可缩放和平移

---

#### FR-A2: 参数动态调节

**功能描述**: 用户可为函数定义参数，通过滑动条实时调节参数值。

**输入规格**:
| 输入项 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| 参数名 | string | 单个字母，非x | `a`, `b`, `k` |
| 初始值 | number | 参数初始值 | `1` |
| 范围 | [number, number] | 滑动条范围 | `[-5, 5]` |
| 步长 | number | 可选，默认0.1 | `0.5` |

**交互行为**:
1. 用户在表达式中使用参数（如 `y = a*x^2 + b`）
2. 系统自动识别参数，生成对应滑动条
3. 拖动滑动条，曲线实时更新

**验收标准**:
- [ ] 自动识别表达式中的参数
- [ ] 滑动条拖动时曲线实时更新，无延迟感
- [ ] 支持同时定义多个参数（最多5个）
- [ ] 参数当前值在滑动条旁显示

---

#### FR-A3: 多函数叠加显示

**功能描述**: 在同一坐标系中显示多条函数曲线进行对比。

**输入规格**:
| 输入项 | 类型 | 说明 |
|--------|------|------|
| 函数列表 | Array<Function> | 最多10条 |
| 曲线颜色 | string[] | 可选，自动分配 |
| 曲线标签 | string[] | 可选，用于图例 |

**交互行为**:
1. 点击"添加函数"按钮新增输入框
2. 每条曲线自动分配不同颜色
3. 图例显示所有曲线，点击可切换显示/隐藏

**验收标准**:
- [ ] 支持同时显示至少5条曲线
- [ ] 曲线颜色自动区分，可自定义
- [ ] 可通过图例切换曲线显示状态
- [ ] 可删除任意一条曲线

---

#### FR-A4: 特殊点标注

**功能描述**: 自动识别并标注函数的特殊点。

**标注类型**:
| 类型 | 标注样式 | 计算方法 |
|------|----------|----------|
| 极大值点 | 红色圆点 + 向上箭头 | f'(x)=0 且 f''(x)<0 |
| 极小值点 | 蓝色圆点 + 向下箭头 | f'(x)=0 且 f''(x)>0 |
| 拐点 | 绿色方点 | f''(x)=0 且 f'''(x)≠0 |
| 零点 | 黄色菱形 | f(x)=0 |

**交互行为**:
- 鼠标悬停标注点显示精确坐标
- 点击标注点显示详细信息卡片

**验收标准**:
- [ ] 正确识别并标注极值点
- [ ] 正确识别并标注拐点
- [ ] 正确识别并标注零点
- [ ] 悬停显示精确坐标（小数点后4位）

---

#### FR-A5: 3D曲面绘制

**功能描述**: 绘制二元函数 z=f(x,y) 的三维曲面。

**输入规格**:
| 输入项 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| 函数表达式 | string | 含x和y的表达式 | `x^2 + y^2` |
| x范围 | [number, number] | 默认[-5, 5] | |
| y范围 | [number, number] | 默认[-5, 5] | |

**交互行为**:
- 鼠标拖动旋转视角
- 滚轮缩放
- 颜色根据z值映射

**验收标准**:
- [ ] 正确渲染3D曲面
- [ ] 支持视角旋转和缩放
- [ ] 颜色映射直观反映高度
- [ ] 渲染流畅不卡顿

---

### 5.2 模块B: 知识点可视化

#### FR-B1: 极限动画演示

**功能描述**: 动态展示函数极限的"趋近"过程。

**演示模式**:

**模式1: 函数极限 lim(x→a) f(x) = L**
```
动画帧序列:
1. 显示函数曲线和目标点a
2. 一个动点从远处开始向a移动
3. 同时在y轴上显示f(x)的值向L靠近
4. ε-δ区域可视化（可选）
```

**模式2: 数列极限 lim(n→∞) a_n = L**
```
动画帧序列:
1. 依次绘制数列各项 a_1, a_2, a_3, ...
2. 显示极限线 y=L
3. 标注项与极限的距离
```

**控制选项**:
| 控制项 | 功能 |
|--------|------|
| 播放/暂停 | 控制动画播放 |
| 速度调节 | 0.5x, 1x, 2x |
| 步进 | 逐帧前进/后退 |
| 重置 | 回到初始状态 |

**验收标准**:
- [ ] 动画清晰展示趋近过程
- [ ] 支持播放控制
- [ ] 可调节动画速度
- [ ] ε-δ演示模式正确显示邻域

---

#### FR-B2: 导数几何意义演示

**功能描述**: 通过切线动画展示导数的几何意义。

**演示内容**:
```
画面元素:
1. 函数曲线 y=f(x)
2. 曲线上的动点 P
3. 点P处的切线
4. 切线斜率值 k=f'(x) 实时显示
```

**交互方式**:
- 自动播放: 点P沿曲线移动，切线随之变化
- 手动拖动: 用户拖动点P到任意位置
- 数值输入: 输入x值直接定位

**验收标准**:
- [ ] 切线始终与曲线相切
- [ ] 斜率值与f'(x)计算结果一致
- [ ] 动画流畅
- [ ] 支持手动拖动点P

---

#### FR-B3: 定积分面积演示

**功能描述**: 动态展示定积分的面积含义。

**演示内容**:
```
画面元素:
1. 函数曲线 y=f(x)
2. 积分区间 [a, b]
3. 曲线与x轴之间的填充区域
4. 面积数值实时显示
```

**动画模式**:
| 模式 | 描述 |
|------|------|
| 黎曼和 | 用矩形逼近，显示分割数n变化 |
| 连续填充 | 从a到b逐渐填充区域 |

**交互行为**:
- 可调整积分上下限 a, b
- 黎曼和模式下可调整分割数n
- 显示正面积(曲线在上)和负面积(曲线在下)的区分

**验收标准**:
- [ ] 正确填充积分区域
- [ ] 面积值与数值积分结果一致
- [ ] 黎曼和模式清晰显示矩形逼近
- [ ] 区分正负面积

---

### 5.3 模块C: AI辅助理解

#### FR-C1: 知识点比喻生成

**功能描述**: 为抽象数学概念提供生活化比喻，帮助理解。

**实现方式: 混合模式**

**预设比喻库** (部分示例):
```yaml
极限:
  - "极限就像追星星，你可以无限接近，但永远到不了"
  - "极限像是排队买奶茶，人越来越近，但总有微小距离"

导数:
  - "导数就是变化的速度，像汽车仪表盘上的时速表"
  - "导数是曲线在某点的'陡峭程度'"

积分:
  - "积分是累加的过程，像银行账户的日结利息"
  - "积分就是数曲线下方有多少'面积'"
```

**AI动态生成**:
- 调用通义千问API
- Prompt模板:
```
请用一个生活化的比喻来解释"{知识点名称}"这个数学概念。
要求:
1. 比喻要通俗易懂，使用日常生活场景
2. 比喻要准确反映概念的核心特征
3. 长度控制在2-3句话
```

**验收标准**:
- [ ] 每个核心知识点至少有2个预设比喻
- [ ] 可请求AI生成新比喻
- [ ] AI响应时间 < 5秒
- [ ] 比喻内容准确无误导

---

#### FR-C2: 智能问答

**功能描述**: 用户可针对数学知识点提问，AI给出解答。

**输入**: 用户自然语言问题
**输出**: AI生成的解答

**Prompt设计**:
```
你是一个高等数学辅导老师，擅长用通俗易懂的方式解释数学概念。

当前用户正在学习: {当前知识点}
用户问题: {用户输入}

请给出准确、易懂的解答。如果涉及公式，请用LaTeX格式。
```

**验收标准**:
- [ ] 正确理解用户问题意图
- [ ] 回答准确且易懂
- [ ] 支持LaTeX公式渲染
- [ ] 响应时间 < 5秒

---

### 5.4 模块D: 知识体系

#### FR-D1: 知识图谱

**功能描述**: 以图形方式展示知识点之间的关联关系。

**图谱结构**:
```
节点: 知识点
边: 依赖关系 (A是B的前置知识)
```

**交互行为**:
- 缩放和平移图谱
- 点击节点高亮关联节点
- 点击节点跳转到详情页

**验收标准**:
- [ ] 清晰展示知识点关联
- [ ] 支持缩放和平移
- [ ] 点击节点可跳转
- [ ] 布局美观不混乱

---

#### FR-D2: 章节大纲导航

**功能描述**: 树形结构展示高等数学全部章节，支持快速导航。

**数据结构**:
```typescript
interface Chapter {
  id: string;
  title: string;
  sections: Section[];
}

interface Section {
  id: string;
  title: string;
  hasVisualization: boolean; // 是否有可视化
}
```

**验收标准**:
- [ ] 完整显示9章内容
- [ ] 支持展开/折叠
- [ ] 点击跳转到对应内容
- [ ] 标识哪些知识点有可视化

---

#### FR-D4: 公式速查卡片

**功能描述**: 按主题分类展示常用公式，支持搜索。

**卡片内容**:
```
- 公式名称
- LaTeX渲染的公式
- 适用场景说明
- 所属章节
```

**验收标准**:
- [ ] 公式渲染清晰准确
- [ ] 按章节/主题分类
- [ ] 支持关键词搜索
- [ ] 点击卡片展开详情

---

## 6. 非功能需求

### 6.1 性能需求

| 需求项 | 指标 | 测量方法 |
|--------|------|----------|
| 启动时间 | < 3秒 | 从双击图标到主界面可交互 |
| 公式渲染 | < 100ms | 从输入完成到曲线显示 |
| 动画帧率 | >= 60fps | 所有动画场景 |
| 内存占用 | < 500MB | 正常使用场景 |
| AI响应 | < 5秒 | 从发送请求到显示结果 |

### 6.2 可用性需求

| 需求项 | 描述 |
|--------|------|
| 学习成本 | 新用户5分钟内完成首次函数绘图 |
| 操作反馈 | 所有操作有明确的视觉反馈 |
| 错误提示 | 错误信息清晰、具有指导性 |
| 帮助文档 | 每个功能模块有使用说明 |

### 6.3 兼容性需求

| 平台 | 最低版本 |
|------|----------|
| Windows | Windows 10 |
| macOS | macOS 10.14 |

### 6.4 离线能力

| 功能 | 离线可用 |
|------|----------|
| 函数绘图 | 是 |
| 知识点可视化 | 是 |
| 预设比喻 | 是 |
| AI动态生成 | 否 |
| 智能问答 | 否 |
| 章节大纲 | 是 |
| 公式卡片 | 是 |

---

## 7. 用户界面需求

### 7.1 整体布局

```
┌──────────────────────────────────────────────────────────┐
│  Logo    [导航标签: 绘图 | 学习 | 公式 | 设置]    [_][□][×]│
├──────────────┬───────────────────────────────────────────┤
│              │                                           │
│   侧边栏     │              主内容区                      │
│   (章节树)   │         (绘图/可视化/内容)                 │
│              │                                           │
│              │                                           │
│              ├───────────────────────────────────────────┤
│              │              底部面板(可选)                │
│              │         (参数控制/动画控制)                │
└──────────────┴───────────────────────────────────────────┘
```

### 7.2 主要页面

#### 页面1: 函数绘图页
- 左侧: 函数输入区、参数滑动条
- 中央: 坐标系和曲线图
- 右侧: 图例、特殊点列表

#### 页面2: 知识学习页
- 左侧: 章节导航树
- 中央: 可视化动画区
- 右侧: 知识点说明、AI比喻

#### 页面3: 公式速查页
- 顶部: 搜索栏、分类筛选
- 主体: 公式卡片网格

### 7.3 设计规范

| 项目 | 规范 |
|------|------|
| 主色调 | 蓝色系 (#409EFF) |
| 字体 | 思源黑体 / Microsoft YaHei |
| 公式字体 | KaTeX默认数学字体 |
| 圆角 | 4px |
| 阴影 | 0 2px 12px rgba(0,0,0,0.1) |

---

## 8. 数据需求

### 8.1 静态数据

#### 知识点数据结构
```typescript
interface KnowledgePoint {
  id: string;
  chapter: number;
  section: number;
  title: string;
  description: string;
  metaphors: string[];        // 预设比喻
  formulas: Formula[];        // 相关公式
  prerequisites: string[];    // 前置知识点ID
  visualizations: string[];   // 可视化组件ID
  examFrequency?: 'high' | 'medium' | 'low'; // 考研频率
}
```

#### 公式数据结构
```typescript
interface Formula {
  id: string;
  name: string;
  latex: string;
  category: string;
  knowledgePointId: string;
  description: string;
}
```

### 8.2 用户数据

```typescript
interface UserProgress {
  visitedKnowledgePoints: string[];  // 访问过的知识点
  favoriteFormulas: string[];        // 收藏的公式
  lastVisitTime: number;             // 上次访问时间
  settings: UserSettings;            // 用户设置
}

interface UserSettings {
  theme: 'light' | 'dark';
  animationSpeed: number;
  defaultXRange: [number, number];
}
```

### 8.3 存储方案

| 数据类型 | 存储位置 |
|----------|----------|
| 静态知识库 | 应用内置JSON文件 |
| 用户进度 | localStorage |
| 用户设置 | localStorage |

---

## 9. 技术约束

### 9.1 技术栈 (已确定)

| 层级 | 技术 |
|------|------|
| 桌面框架 | Electron |
| 前端框架 | Vue 3 + TypeScript |
| 状态管理 | Pinia |
| UI组件库 | Element Plus |
| 图表库 | ECharts |
| 动画库 | D3.js |
| 公式渲染 | KaTeX |
| 公式解析 | Math.js |
| AI服务 | 通义千问 API |

### 9.2 第三方依赖

| 依赖 | 用途 | 许可证 |
|------|------|--------|
| electron | 桌面应用框架 | MIT |
| vue | 前端框架 | MIT |
| echarts | 图表渲染 | Apache 2.0 |
| d3 | 数据可视化 | ISC |
| mathjs | 数学计算 | Apache 2.0 |
| katex | 公式渲染 | MIT |

---

## 10. 发布计划

### Phase 1: MVP v0.1
**范围**: A1-A4, B1-B3, D2
**目标**: 核心绘图和基础可视化

### Phase 2: v0.2
**范围**: C1, D1, D4
**目标**: AI能力和知识体系

### Phase 3: v0.3
**范围**: A5, B4-B5, 全章节内容
**目标**: 功能完善

### Phase 4: v1.0
**范围**: C2, C4, D3
**目标**: 完整产品体验

---

## 11. 开放问题

| ID | 问题 | 状态 | 决策 |
|----|------|------|------|
| Q1 | 是否需要支持Linux? | 待定 | MVP暂不支持 |
| Q2 | AI API Key如何管理? | 待定 | 用户自行配置 |
| Q3 | 是否需要自动更新功能? | 待定 | v1.0考虑 |

---

## 12. 附录

### A. 高等数学知识体系完整列表

(见产品简报)

### B. 术语表

| 术语 | 定义 |
|------|------|
| MVP | Minimum Viable Product，最小可行产品 |
| PRD | Product Requirements Document，产品需求文档 |
| P0/P1/P2 | 优先级，P0最高 |

---

**文档版本**: v1.0
**创建日期**: 2025-12-03
**状态**: 待架构设计
